To : Hideki Yamane <henrich@iijmio-mail.jp>, 866401@bugs.debian.org
Subject : Bug#866401: Please print proper error message when download fails
From : Raphael Hertzog <hertzog@debian.org>
Date : Thu, 22 Mar 2018 09:59:21 +0100
Message-id : 20180322085921.GF21310@home.ouaza.com
Reply-to : Raphael Hertzog <hertzog@debian.org>, 866401@bugs.debian.org
In-reply-to : <[ðŸ”Ž]Â 20180321193811.6b82c61b77a3b03a8d0d37dc@iijmio-mail.jp>
References : <22869.3769.148675.804802@mariner.uk.xensource.com> <[ðŸ”Ž]Â 20180321193811.6b82c61b77a3b03a8d0d37dc@iijmio-mail.jp> <22869.3769.148675.804802@mariner.uk.xensource.com>


Hi,
On Wed, 21 Mar 2018, Hideki Yamane wrote:
> On Wed, 21 Mar 2018 18:15:06 +0900 Hideki Yamane <henrich@iijmio-mail.jp> wrote:
> >  Then, how about to change it to "-nv" (no-verbose) option?
> 
>  Here's a proposed patch.
busybox's wget does not fail with this option but it also does not change
its behaviour. And we already have the verbose option to enable verbose
logging so this is really not necessary.
I think that your whole interpretation of this bug report is flawed. The bug
reporter complains of this error message:
E: Couldn't download dists/jessie/main/binary-armhf/Packages
And fixing it to include the full URL is not hard:
--- a/functions
+++ b/functions
@@ -675,7 +675,7 @@ download_release_indices () {
                        if get "$m/$path" "$pkgdest" $ext; then break; fi
                done
                if [ ! -f "$pkgdest" ]; then
-                       error 1 COULDNTDL "Couldn't download %s" "$path"
+                       error 1 COULDNTDL "Couldn't download %s" "$m/$path"
                fi
                donepkgs="$(($donepkgs + ${i#* }))"
                progress $donepkgs $totalpkgs DOWNPKGS "Downloading Packages files"
@@ -722,7 +722,7 @@ download_debs () {
                                        echo >>$TARGET/debootstrap/deburis "$p $ver $m/$fil"
                                        echo >>$TARGET/debootstrap/debpaths "$p $debdest"
                                else
-                                       warning COULDNTDL "Couldn't download package %s (ver %s arch %s)" "$p" "$ver" "$arc"
+                                       warning COULDNTDL "Couldn't download package %s (ver %s arch %s) at %s" "$p" "$ver" "$arc" "$m/$fil"
                                        leftover="$leftover $p"
                                fi
                        fi
I fixed another similar error message at the same time.
And this error message does not seem to be generated by debootstrap
Cheers,
-- 
RaphaÃ«l Hertzog â—ˆ Debian Developer
Support Debian LTS: https://www.freexian.com/services/debian-lts.html
Learn to master Debian: https://debian-handbook.info/get/